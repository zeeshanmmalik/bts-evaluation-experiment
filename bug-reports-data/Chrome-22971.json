{
    "project": "Chrome", 
    "original_link": "http://dont.know.yet/22971", 
    "comments": [
        {
            "date": "2009-09-24 16:01:40", 
            "sentences": [
                {
                    "is_in_lex_summary": true, 
                    "text": "A webkit roll (http://src.chromium.org/viewvc/chrome?\n", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "view=rev&revision=27139) caused http://chrome-\n", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "buildbot.corp.google.com:8010/builders/Mac10.5%20Tests%20(dbg)(2)/build\ns/5465/steps/unit_tests/logs/stdio to happen.", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  It believe it's because of \nhttp://trac.webkit.org/changeset/48732\n", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "sudden termination calls go back to the WebKitClient.", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  It looks like the client \nis null at the time.\n", 
                    "is_in_email_summary": true
                }
            ], 
            "name": "/u/jorlow@chromium.org/", 
            "email": "/u/jorlow@chromium.org/"
        }, 
        {
            "date": "2009-09-24 16:07:09", 
            "sentences": [
                {
                    "is_in_lex_summary": true, 
                    "text": "The following revision refers to this bug:\n", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "    http://src.chromium.org/viewvc/chrome?", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "view=rev&revision=27144 \n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "------------------------------------------------------------------------\nr27144 | jorlow@chromium.org | 2009-09-24 16:06:56 -0700 (Thu, 24 Sep 2009) | 7 lines\nChanged paths:\n", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "   M http://src.chromium.org/viewvc/chrome/trunk/src/chrome/renderer/extensions/json_schema_unittest.cc?", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "r1=27144&r2=27143\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "Disable the json_schema_unittest since it crashes after a WebKit deps roll.\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "TBR=nsylvain\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "TEST=Unit tests now work.\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "BUG=22971\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "Review URL: http://codereview.chromium.org/231024\n", 
                    "is_in_email_summary": false
                }
            ], 
            "name": "/u/bugdroid1@chromium.org/", 
            "email": "/u/bugdroid1@chromium.org/"
        }, 
        {
            "date": "2009-09-24 16:23:17", 
            "sentences": [
                {
                    "is_in_lex_summary": true, 
                    "text": "(No comment was entered for this change.)\n", 
                    "is_in_email_summary": true
                }
            ], 
            "name": "/u/jorlow@chromium.org/", 
            "email": "/u/jorlow@chromium.org/"
        }, 
        {
            "date": "2009-09-24 16:40:18", 
            "sentences": [
                {
                    "is_in_lex_summary": false, 
                    "text": "Uh oh.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "  This is pretty nasty.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "  Take a look at this stack trace:\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#0\t0x008f287f in WebCore::ChromiumBridge::suddenTerminationChanged at \nChromiumBridge.cpp:369\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#1\t0x01651162 in WebCore::enableSuddenTermination at \n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "SuddenTerminationChromium.cpp:45\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#2\t0x015f0e60 in WebCore::removeAllUnloadEventListeners at \n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "DOMWindow.cpp:149\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#3\t0x015f0ed1 in WebCore::DOMWindow::~DOMWindow at DOMWindow.cpp:367\n#4\t0x013f909b in WTF::RefCounted<WebCore::DOMWindow>::deref at \nRefCounted.h:109\n", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#5\t0x01281ece in WebCore::DOMData::derefObject at DOMData.cpp:91\n#6\t0x0128297c in WebCore::DOMData::ensureDeref at DOMData.cpp:66\n#7\t0x01287319 in WebCore::DOMData::handleWeakObject<void> at \nDOMData.h:111\n", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#8\t0x012840d6 in WebCore::DOMDataStore::weakDOMObjectCallback at \nDOMDataStore.cpp:149\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#9\t0x00ecc4c4 in \n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "v8::internal::GlobalHandles::Node::PostGarbageCollectionProcessing at global-\nhandles.cc:166\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#10\t0x00ecb82f in v8::internal::GlobalHandles::PostGarbageCollectionProcessing at \nglobal-handles.cc:290\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#11\t0x00edc914 in v8::internal::Heap::PostGarbageCollectionProcessing at \nheap.cc:498\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#12\t0x00edcab1 in v8::internal::Heap::PerformGarbageCollection at heap.cc:478\n#13\t0x00edcf05 in v8::internal::Heap::CollectGarbage at heap.cc:378\n#14\t0x00edd10e in v8::internal::Heap::CollectAllGarbage at heap.cc:328\n#15\t0x00edd2bb in v8::internal::Heap::CollectAllGarbageIfContextDisposed at \nheap.cc:340\n", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#16\t0x00e76809 in v8::Context::New at api.cc:2630\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#17\t0x00346c58 in V8UnitTest::SetUp at v8_unit_test.cc:14\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#18\t0x00337a5c in JsonSchemaTest::SetUp at json_schema_unittest.cc:23\n#19\t0x009b2d7d in testing::Test::Run at gtest.cc:2051\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#20\t0x009b6f69 in testing::internal::TestInfoImpl::Run at gtest.cc:2287\n#21\t0x009bc2ef in testing::internal::TestInfoImpl::RunTest at gtest-internal-\ninl.h:655\n", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#22\t0x009b79a5 in testing::internal::List<testing::TestInfo*>::ForEach<void \n(*)(testing::TestInfo*)> at gtest-internal-inl.h:397\n", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#23\t0x009b6e4e in testing::TestCase::Run at gtest.cc:2383\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#24\t0x009bc2d3 in testing::TestCase::RunTestCase at gtest-internal-inl.h:776\n#25\t0x009b77db in testing::internal::List<testing::TestCase*>::ForEach<void \n(*)(testing::TestCase*)> at gtest-internal-inl.h:397\n", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#26\t0x009b6cad in testing::internal::UnitTestImpl::RunAllTests at gtest.cc:3670\n#27\t0x009b6da6 in testing::UnitTest::Run at gtest.cc:3404\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#28\t0x008daf33 in TestSuite::Run at test_suite.h:93\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "#29\t0x008d96dc in main at run_all_unittests.cc:8\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "At first glance, it looks like we just need to initialize the webKitClient.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  But, if you \nlook closer, you'll see we're trying to destroy a DOMWindow!", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  I think this has just \nexposed a bug in V8.\n", 
                    "is_in_email_summary": false
                }
            ], 
            "name": "/u/jorlow@chromium.org/", 
            "email": "/u/jorlow@chromium.org/"
        }, 
        {
            "date": "2009-09-24 18:05:48", 
            "sentences": [
                {
                    "is_in_lex_summary": false, 
                    "text": "Ok, so here's what's happening: Some other unittest is doing stuff that creates a DOMWindow.", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  At some point in the future, is Json schema unit \ntest runs.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  It calls v8::Context::New which triggers a GC.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "  It just so happens that this GC cleans out a DOMWindow object.\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "After the WebKit roll, DOMWindow's destructor triggers an enableSuddentTermination.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "  This then tries to call out through our WebKitClient \nwhich is still NULL.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "  So it dereferences NULL.\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "After searching the source code, I think there's a good chance that only those tests that inherit from V8UnitTest would ever trigger a GC.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "  If \nthis is true, then SetUp could initialize WebKit with a dummy WebKitClient.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  Unfortunately, it's hard to know for sure whether this will fix it or if \nthe problem will just show up at a later date.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  In addition, then we 1) have another WebKitClient derivative to maintain (BIG pain in the ass) and \n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "2) we have to mock it by hand (not use googlemock) since it uses some WebCore types.\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "We could also find the test that's causing the problem, initialize WebKit there and force a GC.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  Unfortunately, GC's are not terribly \ndeterministic, so it'll probably just break in some point in the future.\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "So the only thing I see left is to make enableSuddenTermination handle webKitClient() being null.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  This seems like a terrible thing to do just to \nmake a test not crash, but I'm out of ideas at this point.\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "If that's not acceptable, I'll hunt down the test that's creating a DOMWindow.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "  Hopefully we can disable it and file a bug on whomever wrote it.\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "If you've got other suggestions, please take a look yourself.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  The only reason I'm even looking at this is that I was unlucky enough to roll the \nWebKit deps (because of a 2 sided patch) past a change that happened to expose this behavior.\n", 
                    "is_in_email_summary": true
                }
            ], 
            "name": "/u/jorlow@chromium.org/", 
            "email": "/u/jorlow@chromium.org/"
        }, 
        {
            "date": "2009-09-24 18:06:10", 
            "sentences": [
                {
                    "is_in_lex_summary": true, 
                    "text": "(No comment was entered for this change.)\n", 
                    "is_in_email_summary": false
                }
            ], 
            "name": "/u/jorlow@chromium.org/", 
            "email": "/u/jorlow@chromium.org/"
        }, 
        {
            "date": "2009-09-24 18:07:33", 
            "sentences": [
                {
                    "is_in_lex_summary": true, 
                    "text": "Oh, I forgot to mention: This test passes if you run it by itself (with --gfilter).", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  So, it's \nnot actually a release blocker.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "  (It can be run by hand.)", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  But I'm just trying to play by the \nnew rules and Erik felt strongly about this.\n", 
                    "is_in_email_summary": false
                }
            ], 
            "name": "/u/jorlow@chromium.org/", 
            "email": "/u/jorlow@chromium.org/"
        }, 
        {
            "date": "2009-09-24 18:18:59", 
            "sentences": [
                {
                    "is_in_lex_summary": false, 
                    "text": "Here's one way to fix it.", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  Technically, it's solid, but philosophically it's less than idea.\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "http://codereview.chromium.org/240001/show\n", 
                    "is_in_email_summary": false
                }
            ], 
            "name": "/u/jorlow@chromium.org/", 
            "email": "/u/jorlow@chromium.org/"
        }, 
        {
            "date": "2009-09-24 18:19:32", 
            "sentences": [
                {
                    "is_in_lex_summary": false, 
                    "text": "+ darin in case he has thoughts\n", 
                    "is_in_email_summary": false
                }
            ], 
            "name": "/u/jorlow@chromium.org/", 
            "email": "/u/jorlow@chromium.org/"
        }, 
        {
            "date": "2009-09-25 13:39:12", 
            "sentences": [
                {
                    "is_in_lex_summary": false, 
                    "text": "Landed: http://codereview.chromium.org/240001\n", 
                    "is_in_email_summary": false
                }
            ], 
            "name": "/u/jorlow@chromium.org/", 
            "email": "/u/jorlow@chromium.org/"
        }, 
        {
            "date": "2009-09-26 15:58:30", 
            "sentences": [
                {
                    "is_in_lex_summary": true, 
                    "text": "The following revision refers to this bug:\n", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "    http://src.chromium.org/viewvc/chrome?", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "view=rev&revision=27239 \n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "------------------------------------------------------------------------\nr27239 | jorlow@chromium.org | 2009-09-25 13:35:57 -0700 (Fri, 25 Sep 2009) | 10 lines\nChanged paths:\n", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "   M http://src.chromium.org/viewvc/chrome/trunk/src/chrome/renderer/extensions/json_schema_unittest.cc?", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "r1=27239&r2=27238\n   M http://src.chromium.org/viewvc/chrome/trunk/src/chrome/test/render_view_test.cc?", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "r1=27239&r2=27238\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "Force garbage collection after running any unit tests that initialize WebViews.\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "It's quite possible that we just plain shouldn't allow any unit tests to\ninitialize WebKit for philosophical and theoretical reasons.", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": true, 
                    "text": "  But this does\nseem to work, so I guess we should just go this route for now.\n", 
                    "is_in_email_summary": true
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "BUG=22971\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "TEST=none\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "\n", 
                    "is_in_email_summary": false
                }, 
                {
                    "is_in_lex_summary": false, 
                    "text": "Review URL: http://codereview.chromium.org/240001\n", 
                    "is_in_email_summary": false
                }
            ], 
            "name": "/u/bugdroid1@chromium.org/", 
            "email": "/u/bugdroid1@chromium.org/"
        }
    ], 
    "title": "JSON unit_tests are disabled because they started crashing after a WebKit deps roll"
}